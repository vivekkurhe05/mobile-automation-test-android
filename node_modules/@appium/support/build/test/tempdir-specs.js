"use strict";

require("source-map-support/register");

var _index = require("../lib/index.js");

describe('tempdir', function () {
  afterEach(function () {
    delete process.env.APPIUM_TMP_DIR;
  });
  it('should be able to generate a path', async function () {
    const path = await _index.tempDir.path({
      prefix: 'myfile',
      suffix: '.tmp'
    });
    path.should.exist;
    path.should.include('myfile.tmp');
  });
  it('should be able to generate a path with process.env.APPIUM_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.APPIUM_TMP_DIR = preRootDirPath;
    const path = await _index.tempDir.path({
      prefix: 'myfile',
      suffix: '.tmp'
    });
    path.should.exist;
    path.should.include(preRootDirPath);
    path.should.include('myfile.tmp');
  });
  it('should be able to create a temp file', async function () {
    let res = await _index.tempDir.open({
      prefix: 'my-test-file',
      suffix: '.zip'
    });
    res.should.exist;
    res.path.should.exist;
    res.path.should.include('my-test-file.zip');
    res.fd.should.exist;
    await _index.fs.exists(res.path).should.eventually.be.ok;
  });
  it('should be able to create a temp file with process.env.APPIUM_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.APPIUM_TMP_DIR = preRootDirPath;
    let res = await _index.tempDir.open({
      prefix: 'my-test-file',
      suffix: '.zip'
    });
    res.should.exist;
    res.path.should.exist;
    res.path.should.include(preRootDirPath);
    res.path.should.include('my-test-file.zip');
    res.fd.should.exist;
    await _index.fs.exists(res.path).should.eventually.be.ok;
  });
  it('should generate a random temp dir', async function () {
    let res = await _index.tempDir.openDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    let res2 = await _index.tempDir.openDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.not.equal(res2);
  });
  it('should generate a random temp dir, but the same with process.env.APPIUM_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.APPIUM_TMP_DIR = preRootDirPath;
    const res = await _index.tempDir.openDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    const res2 = await _index.tempDir.openDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.include(preRootDirPath);
    res2.should.include(preRootDirPath);
    res.should.not.equal(res2);
  });
  it('should generate one temp dir used for the life of the process', async function () {
    let res = await _index.tempDir.staticDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    let res2 = await _index.tempDir.staticDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.equal(res2);
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdGVtcGRpci1zcGVjcy5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsImFmdGVyRWFjaCIsInByb2Nlc3MiLCJlbnYiLCJBUFBJVU1fVE1QX0RJUiIsIml0IiwicGF0aCIsInRlbXBEaXIiLCJwcmVmaXgiLCJzdWZmaXgiLCJzaG91bGQiLCJleGlzdCIsImluY2x1ZGUiLCJwcmVSb290RGlyUGF0aCIsIm9wZW5EaXIiLCJyZXMiLCJvcGVuIiwiZmQiLCJmcyIsImV4aXN0cyIsImV2ZW50dWFsbHkiLCJiZSIsIm9rIiwiYSIsInJlczIiLCJub3QiLCJlcXVhbCIsInN0YXRpY0RpciJdLCJtYXBwaW5ncyI6Ijs7OztBQUNBOztBQUdBQSxRQUFRLENBQUMsU0FBRCxFQUFZLFlBQVk7QUFDOUJDLEVBQUFBLFNBQVMsQ0FBQyxZQUFZO0FBRXBCLFdBQU9DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxjQUFuQjtBQUNELEdBSFEsQ0FBVDtBQUtBQyxFQUFBQSxFQUFFLENBQUMsbUNBQUQsRUFBc0Msa0JBQWtCO0FBQ3hELFVBQU1DLElBQUksR0FBRyxNQUFNQyxlQUFRRCxJQUFSLENBQWE7QUFBQ0UsTUFBQUEsTUFBTSxFQUFFLFFBQVQ7QUFBbUJDLE1BQUFBLE1BQU0sRUFBRTtBQUEzQixLQUFiLENBQW5CO0FBQ0FILElBQUFBLElBQUksQ0FBQ0ksTUFBTCxDQUFZQyxLQUFaO0FBQ0FMLElBQUFBLElBQUksQ0FBQ0ksTUFBTCxDQUFZRSxPQUFaLENBQW9CLFlBQXBCO0FBQ0QsR0FKQyxDQUFGO0FBTUFQLEVBQUFBLEVBQUUsQ0FBQyxtRUFBRCxFQUFzRSxrQkFBa0I7QUFDeEYsVUFBTVEsY0FBYyxHQUFHLE1BQU1OLGVBQVFPLE9BQVIsRUFBN0I7QUFDQVosSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlDLGNBQVosR0FBNkJTLGNBQTdCO0FBRUEsVUFBTVAsSUFBSSxHQUFHLE1BQU1DLGVBQVFELElBQVIsQ0FBYTtBQUFDRSxNQUFBQSxNQUFNLEVBQUUsUUFB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QWhCLENBQXVCVSxVQUF2QixDQUFrQ0MsRUFBbEMsQ0FBcUNDLEVBQTNDO0FBQ0FQLElBQUFBLEdBQUcsQ0FBQ0wsTUFBSixDQUFXZ0IsS0FBWCxDQUFpQkYsSUFBakI7QUFDRCxHQVBDLENBQUY7QUFRRCxDQTNFTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyB0ZW1wRGlyLCBmcyB9IGZyb20gJy4uL2xpYi9pbmRleC5qcyc7XG5cblxuZGVzY3JpYmUoJ3RlbXBkaXInLCBmdW5jdGlvbiAoKSB7XG4gIGFmdGVyRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgLy8gc2V0IHRoZSBwcm9jZXNzIGVudiBhcyB1bmRlZmllbmRcbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuQVBQSVVNX1RNUF9ESVI7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgYWJsZSB0byBnZW5lcmF0ZSBhIHBhdGgnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcGF0aCA9IGF3YWl0IHRlbXBEaXIucGF0aCh7cHJlZml4OiAnbXlmaWxlJywgc3VmZml4OiAnLnRtcCd9KTtcbiAgICBwYXRoLnNob3VsZC5leGlzdDtcbiAgICBwYXRoLnNob3VsZC5pbmNsdWRlKCdteWZpbGUudG1wJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgYWJsZSB0byBnZW5lcmF0ZSBhIHBhdGggd2l0aCBwcm9jZXNzLmVudi5BUFBJVU1fVE1QX0RJUicsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwcmVSb290RGlyUGF0aCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIHByb2Nlc3MuZW52LkFQUElVTV9UTVBfRElSID0gcHJlUm9vdERpclBhdGg7XG5cbiAgICBjb25zdCBwYXRoID0gYXdhaXQgdGVtcERpci5wYXRoKHtwcmVmaXg6ICdteWZpbGUnLCBzdWZmaXg6ICcudG1wJ30pO1xuICAgIHBhdGguc2hvdWxkLmV4aXN0O1xuICAgIHBhdGguc2hvdWxkLmluY2x1ZGUocHJlUm9vdERpclBhdGgpO1xuICAgIHBhdGguc2hvdWxkLmluY2x1ZGUoJ215ZmlsZS50bXAnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhYmxlIHRvIGNyZWF0ZSBhIHRlbXAgZmlsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcmVzID0gYXdhaXQgdGVtcERpci5vcGVuKHtwcmVmaXg6ICdteS10ZXN0LWZpbGUnLCBzdWZmaXg6ICcuemlwJ30pO1xuICAgIHJlcy5zaG91bGQuZXhpc3Q7XG4gICAgcmVzLnBhdGguc2hvdWxkLmV4aXN0O1xuICAgIHJlcy5wYXRoLnNob3VsZC5pbmNsdWRlKCdteS10ZXN0LWZpbGUuemlwJyk7XG4gICAgcmVzLmZkLnNob3VsZC5leGlzdDtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzLnBhdGgpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gY3JlYXRlIGEgdGVtcCBmaWxlIHdpdGggcHJvY2Vzcy5lbnYuQVBQSVVNX1RNUF9ESVInLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcHJlUm9vdERpclBhdGggPSBhd2FpdCB0ZW1wRGlyLm9wZW5EaXIoKTtcbiAgICBwcm9jZXNzLmVudi5BUFBJVU1fVE1QX0RJUiA9IHByZVJvb3REaXJQYXRoO1xuXG4gICAgbGV0IHJlcyA9IGF3YWl0IHRlbXBEaXIub3Blbih7cHJlZml4OiAnbXktdGVzdC1maWxlJywgc3VmZml4OiAnLnppcCd9KTtcbiAgICByZXMuc2hvdWxkLmV4aXN0O1xuICAgIHJlcy5wYXRoLnNob3VsZC5leGlzdDtcbiAgICByZXMucGF0aC5zaG91bGQuaW5jbHVkZShwcmVSb290RGlyUGF0aCk7XG4gICAgcmVzLnBhdGguc2hvdWxkLmluY2x1ZGUoJ215LXRlc3QtZmlsZS56aXAnKTtcbiAgICByZXMuZmQuc2hvdWxkLmV4aXN0O1xuICAgIGF3YWl0IGZzLmV4aXN0cyhyZXMucGF0aCkuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZ2VuZXJhdGUgYSByYW5kb20gdGVtcCBkaXInLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHJlcyA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIHJlcy5zaG91bGQuYmUuYSgnc3RyaW5nJyk7XG4gICAgYXdhaXQgZnMuZXhpc3RzKHJlcykuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gICAgbGV0IHJlczIgPSBhd2FpdCB0ZW1wRGlyLm9wZW5EaXIoKTtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzMikuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gICAgcmVzLnNob3VsZC5ub3QuZXF1YWwocmVzMik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZ2VuZXJhdGUgYSByYW5kb20gdGVtcCBkaXIsIGJ1dCB0aGUgc2FtZSB3aXRoIHByb2Nlc3MuZW52LkFQUElVTV9UTVBfRElSJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHByZVJvb3REaXJQYXRoID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgcHJvY2Vzcy5lbnYuQVBQSVVNX1RNUF9ESVIgPSBwcmVSb290RGlyUGF0aDtcblxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIHJlcy5zaG91bGQuYmUuYSgnc3RyaW5nJyk7XG4gICAgYXdhaXQgZnMuZXhpc3RzKHJlcykuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gICAgY29uc3QgcmVzMiA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIGF3YWl0IGZzLmV4aXN0cyhyZXMyKS5zaG91bGQuZXZlbnR1YWxseS5iZS5vaztcbiAgICByZXMuc2hvdWxkLmluY2x1ZGUocHJlUm9vdERpclBhdGgpO1xuICAgIHJlczIuc2hvdWxkLmluY2x1ZGUocHJlUm9vdERpclBhdGgpO1xuICAgIHJlcy5zaG91bGQubm90LmVxdWFsKHJlczIpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGdlbmVyYXRlIG9uZSB0ZW1wIGRpciB1c2VkIGZvciB0aGUgbGlmZSBvZiB0aGUgcHJvY2VzcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcmVzID0gYXdhaXQgdGVtcERpci5zdGF0aWNEaXIoKTtcbiAgICByZXMuc2hvdWxkLmJlLmEoJ3N0cmluZycpO1xuICAgIGF3YWl0IGZzLmV4aXN0cyhyZXMpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICAgIGxldCByZXMyID0gYXdhaXQgdGVtcERpci5zdGF0aWNEaXIoKTtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzMikuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gICAgcmVzLnNob3VsZC5lcXVhbChyZXMyKTtcbiAgfSk7XG59KTtcbiJdLCJmaWxlIjoidGVzdC90ZW1wZGlyLXNwZWNzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
